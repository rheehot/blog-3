
<!DOCTYPE html>
<html lang="en">
    

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="아내와 아들 그리고 딸밖에 모르는 남편">
    <title>
        Category: Tech - 아내와 아들 그리고 딸밖에 모르는 남편
    </title>
    <meta name="author" content="sculove">
    
    <meta name="keywords" content="frontend,javascript,developer,">
    
    
    
    <link rel="alternate" type="application/atom+xml" title="RSS" href="/blog/rss2.xml">
    
    <link rel="canonical" href="http://sculove.github.io/blog/categories/tech/page/2/">
    <script type="application/ld+json">{}</script>
    <meta name="description" content="FrontEnd 개발자. JavaScript, RxJS, Angular, React 기술 경험 블로그">
<meta name="keywords" content="frontend,javascript,developer">
<meta property="og:type" content="blog">
<meta property="og:title" content="아내와 아들 그리고 딸밖에 모르는 남편">
<meta property="og:url" content="http://sculove.github.io/blog/categories/Tech/page/2/index.html">
<meta property="og:site_name" content="아내와 아들 그리고 딸밖에 모르는 남편">
<meta property="og:description" content="FrontEnd 개발자. JavaScript, RxJS, Angular, React 기술 경험 블로그">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="아내와 아들 그리고 딸밖에 모르는 남편">
<meta name="twitter:description" content="FrontEnd 개발자. JavaScript, RxJS, Angular, React 기술 경험 블로그">
    
    
    
    
    
    <meta property="og:image" content="http://sculove.github.io/blog/assets/images/sculove.jpeg">
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/blog/assets/css/all.css">
    <link rel="stylesheet" href="/blog/assets/css/jquery.fancybox.css">
    <link rel="stylesheet" href="/blog/assets/css/thumbs.css">
    <link rel="stylesheet" href="/blog/assets/css/tranquilpeak.css">
    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-37362821-12"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-37362821-12');
    </script>


    
</head>
    <body>
        <div id="blog">
            <!-- Define author's picture -->


<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/blog/ ">아내와 아들 그리고 딸밖에 모르는 남편</a>
    </div>
    
        
            <a class="header-right-icon open-algolia-search" href="#search">
        
        
            <i class="fa fa-search fa-lg"></i>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/blog/#about">
                    <img class="sidebar-profile-picture" src="/blog/assets/images/sculove.jpeg" alt="Author&#39;s picture">
                </a>
                <h4 class="sidebar-profile-name">sculove</h4>
                
                    <h5 class="sidebar-profile-bio"><p>아내와 아들 그리고 딸밖에 모르는 남편</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/blog/ " title="Home">
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/blog/all-categories" title="Categories">
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/blog/all-tags" title="Tags">
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/blog/all-archives" title="Archives">
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link open-algolia-search" href="#search" title="Search">
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="#about" title="About">
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://github.com/sculove" target="_blank" rel="external nofollow noopener noreferrer" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://www.facebook.com/chanuk.son" target="_blank" rel="external nofollow noopener noreferrer" title="Facebook">
                    
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://kr.linkedin.com/in/chan-uk-son-8989ba56" target="_blank" rel="external nofollow noopener noreferrer" title="LinkedIn">
                    
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="mailto:sculove@gmail.com" target="_blank" rel="external nofollow noopener noreferrer" title="Mail">
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://sculove.github.io/blog/rss2.xml" target="_blank" rel="noopener" title="RSS">
                    
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1" class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/blog/2017/06/30/rxjsbook1/">
                            RxJS가 해결하려고했던 문제1 - 입력 데이터의 오류
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2017-06-30T05:59:51+09:00">
	
		    Jun 30, 2017
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/blog/categories/Tech/">Tech</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>몇일 전에 요즘 내가 쓰고 있는 책의 초안을 일부를 공개하기로 셀프 선언한 이후, 사실 너무 바빴다 ㅠㅠ<br>1부 탈고일이 좀 남았지만… 마음이 급하다.<br>지인과는 과감히 탕수육 내기도 했으니. 더 급하다.</p>
<p>처음이니깐 간단히 책소개만 해보면.</p>
<blockquote>
<p>RxJS가 무엇을 위해 준비된 라이브러리인지에 대한 답을 구하는 책이다. 더불어 RxJS의 활용법도 학습하는 책이다. 참고로 rxjs5 기준으로 쓰고 있다</p>
<img src="/blog/2017/06/30/rxjsbook1/rxjs.png">
</blockquote>
<p>오늘 소개할 부분은<br>웹어플리케이션 개발시 발생할 수 있는 <code>입력 오류</code>를 RxJS는 어떻게 접근했는지에 대한 이야기이다.</p>
<hr>
<h2 id="웹어플리케이션의-입력-데이터"><a href="#웹어플리케이션의-입력-데이터" class="headerlink" title="웹어플리케이션의 입력 데이터"></a>웹어플리케이션의 입력 데이터</h2><p>웹어플리케이션의 동작 과정을 되돌아보면 사실 몇 개의 큰 과정으로 나눌 수 있다.</p>
<p>간단한 게시판을 예로 생각해보자.<br>게시판은 서버에 저장된 글을 보여주는 목록화면과 게시글의 내용을 보여주는 상세화면으로 구성되어 있다.<br>서버로부터 저장된 글에 대한 정보를 받고, 받은 정보를 바탕으로 화면과 관련된 UI작업을 한다.<br>게시글의 종류나 카테고리를 셀렉트 박스로 표현할 수도 있고, 작성된 글의 내용 일부를 화면에 표현하기도 한다.</p>
<p>또한 사용자가 게시글을 등록. 수정하는 편집화면도 있다. 편집화면에서는 사용자가 셀렉트 박스를 선택하기도 하고, 글을 입력하기도 한다. 사용자의 입력이 잘못된 경우에는 사용자에게 메시지를 전달하기도 하기도 한다.<br>글의 작성 및 수정이 끝나면 등록한 정보를 서버에 저장한다.</p>
<p>이 과정을 <code>데이터가 흐르는 관점</code>으로 살펴보면</p>
<ul>
<li><ol>
<li>목록화면과 조회화면은 서버로부터 데이터를 불러와 브라우저에게 전달한다.</li>
</ol>
</li>
<li><ol start="2">
<li>브라우저에 전달된 정보를 브라우저의 UI객체에 전달한다.</li>
</ol>
</li>
<li><ol start="3">
<li>편집화면은 브라우저 UI객체를 통해 사용자 입력정보를 전달받고 이를 다시 브라우저의 다른 UI객체나 브라우저 객체에 전달한다.</li>
</ol>
</li>
<li><ol start="4">
<li>사용자가 작성한 정보를 브라우저 UI객체나 브라우저 객체를 이용하여 서버로 전달한다.</li>
</ol>
</li>
</ul>
<p>이 과정을 다시 <code>상태머신</code> 관점에서 살펴보자.<br>1)과 2)의 과정에서 입력값은 <code>서버로부터 전달 받은 게시글 데이터</code>가 된다. 두 과정의 입력값이 동일 할지라도 입력값을 받는 브라우저와 브라우저 UI 객체는 <code>서로 다른 시점</code>에 입력값을 전달받는다.<br>예를 들어 1)과정이 Ajax로 JSON 데이터를 받아와 브라우저의 객체로 저장하는 경우라면 Ajax는 비동기(Asynchronous) 호출로 데이터를 받기 까지 시간이 걸린다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// XMLHttpRequest에 의해 입력된 데이터</span></span><br><span class="line"><span class="keyword">let</span> result;</span><br><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.onload = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * Ajax를 통해 얻은 데이터를 result 변수에 저장한다.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * &#123;</span></span><br><span class="line"><span class="comment">   *   list: [</span></span><br><span class="line"><span class="comment">   *      "게시글1번. 안녕하세요.",</span></span><br><span class="line"><span class="comment">   *      "게시글2번. 반갑습니다.",</span></span><br><span class="line"><span class="comment">   *      "게시글3번. RxJS에 대해 알아봐요."</span></span><br><span class="line"><span class="comment">   *   ]</span></span><br><span class="line"><span class="comment">   * &#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  result = <span class="built_in">JSON</span>.parse(xhr.responseText);</span><br><span class="line">&#125;;</span><br><span class="line">xhr.open(<span class="string">"GET"</span>, url);</span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>

<p>반면, 브라우저 UI객체는 이미 브라우저에 존재하는 JSON 데이터를 받기 때문에 동기(Synchronous) 호출로 바로 결과 데이터를 얻을수 있다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.from(<span class="built_in">document</span>.querySelectorAll(<span class="string">"li"</span>)).forEach(<span class="function">(<span class="params">v, i</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Ajax의 결과인 result 변수를 이용하여 DOM에 정보를 표현한다.</span></span><br><span class="line">  v.innerText = result.list[i];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>마찬가지로 3)과 4)의 과정도 입력값은 <code>사용자의 입력</code>이 되지만, 전달된 입력값을 처리하는 시점은 상황에 따라 각각 다르다.</p>
<p>앞에서 설명한 내용을 간단히 정리하면 다음과 같다.</p>
<table>
<thead>
<tr>
<th>과정</th>
<th>데이터</th>
<th>데이터 흐름</th>
<th>전달 시점</th>
<th>예제</th>
</tr>
</thead>
<tbody><tr>
<td>1)</td>
<td>게시글</td>
<td>서버 -&gt; 브라우저</td>
<td>비동기</td>
<td>Ajax 통신으로 JSON 데이터를 받는다.</td>
</tr>
<tr>
<td>2)</td>
<td>게시글</td>
<td>브라우저 -&gt; 브라우저 UI 객체</td>
<td>동기</td>
<td>JSON 데이터를 UI에 반영한다.</td>
</tr>
<tr>
<td>3)</td>
<td>사용자가 입력한 내용</td>
<td>사용자 -&gt; 브라우저 UI객체</td>
<td>비동기</td>
<td>&lt;textarea&gt;를 통해 사용자 입력을 받는다.</td>
</tr>
<tr>
<td>4)</td>
<td>사용자가 입력한 내용</td>
<td>브라우저 UI 객체 -&gt; 브라우저 -&gt; 서버</td>
<td>동기, 비동기</td>
<td>&lt;textarea&gt;에 있는 데이터를 JSON 객체로 저장 후, 서버로 Ajax 요청을 한다</td>
</tr>
</tbody></table>
<h2 id="입력-데이터의-전달-시점이-다양하다"><a href="#입력-데이터의-전달-시점이-다양하다" class="headerlink" title="입력 데이터의 전달 시점이 다양하다."></a>입력 데이터의 전달 시점이 다양하다.</h2><p>앞에서 살펴본 바와 같이 입력데이터가 같을지라도 실제 각 객체들 사이로 데이터가 전달되는 시점은 다르다. 어떤 상황에서는 동기(Synchronous) 방식으로 데이터를 주고 받고, 어떤 상황에서는 비동기(Asynchronous) 방식으로 데이터를 주고 받는다.<br>이런 구조는 비단 웹어플리케이션 뿐만이 아니다. 소프트웨어 전반적으로 이와 같은 상황이 발생한다.<br>이런 이유는 두 방식의 차이점을 살펴보면 보다 명확히 알수 있다.</p>
<h3 id="동기-Synchronous"><a href="#동기-Synchronous" class="headerlink" title="동기(Synchronous)"></a>동기(Synchronous)</h3><p>동기방식은 작업이 들어온 순서에 맞게 차근차근 하나씩 진행되는 것을 의미한다. 호출하는 함수가 호출되는 함수의 작업 완료를 기다린 후 그 다음을 진행하는 방식이다. 이 방식의 장점은 순차적으로 진행되기 때문에 개발이 쉽다. 반면, 처리하는 작업이 많을 경우에는 전체 작업 속도가 느려진다. 특히, 웹브라우저와 같이 단일 UI쓰레드를 사용하는 경우에는 해당 작업이 끝날때까지 브라우저는 대기하고 있어야만 한다.</p>
<img src="/blog/2017/06/30/rxjsbook1/sync.png" title="Synchronous">

<h3 id="비동기-Asynchronous"><a href="#비동기-Asynchronous" class="headerlink" title="비동기(Asynchronous)"></a>비동기(Asynchronous)</h3><p>반면, 비동기 방식은 작업이 들어온 순서에 상관없이 산발적으로 진행되는 것을 의미한다. 호출하는 함수가 호출되는 함수의 작업 완료를 기다리지 않고, 그 다음을 진행하고 호출되는 함수의 작업이 완료되면 별도의 이벤트나 callback 함수를 통해 결과를 전달하는 방식이다. 이 방식의 장점은 효과적으로 작업을 진행할 수 있다는 점이다. 설사 먼저 실행된 작업의 처리시간이 오래걸리더라도 다른 작업을 진행할 수 있다. 반면, 개발은 더욱 복잡해지고 오류 확률은 높아질 우려가 있다.</p>
<img src="/blog/2017/06/30/rxjsbook1/async.png" title="Asynchronous">

<h2 id="동기와-비동기를-함께-사용할-수-밖에-없는가"><a href="#동기와-비동기를-함께-사용할-수-밖에-없는가" class="headerlink" title="동기와 비동기를 함께 사용할 수 밖에 없는가?"></a>동기와 비동기를 함께 사용할 수 밖에 없는가?</h2><p>동기 방식은 명확한 순서를 보장하면서 코드의 흐름과 프로그램의 흐름을 동일하게 처리하는 장점이 있지만, 비동기에 비해 효과적인 작업을 할 수 없다.<br>반면, 비동기 방식은효과적으로 작업을 할 수 있지만 호출의 순서를 보장하기가 어렵다. 이를 보장하기 위해서는 우리는 많은 작업들을 추가적으로 해야만 한다.</p>
<p>그렇다면 모두 동기 방식으로 개발하면 개발 생산성도 높이고, 오류의 발생빈도도 더 낮출수 있기 때문에 다른 한편으로는 더 좋은 선택이지 않는가?</p>
<p>틀린말은 아니다. 하지만 결론부터 이야기하면 그렇게 할수가 없다.<br>기반 플래폼이 제공하는 API자체가 동기 또는 비동기 방식을 제공하고 있기 때문에 본질적으로 우리는 이 문제를 피해갈 수가 없다.<br>특히 단일 쓰레드 기반의 브라우저 환경에서는 비동기 방식을 사용하지 않으면 성능 문제를 해결할 수 없기 때문에 우리에게는 선택의 여지가 없다.</p>
<h2 id="RxJS는-어떻게-개선하였나"><a href="#RxJS는-어떻게-개선하였나" class="headerlink" title="RxJS는 어떻게 개선하였나?"></a>RxJS는 어떻게 개선하였나?</h2><p>RxJS가 주목했던 부분은 바로 이 입력 데이터에 대한 구조적 문제를 개선하고자 하였다.</p>
<p>RxJS는 이런 구조적인 문제를 개선하기 위해 <code>단 하나의 방식</code>을 사용할 수 있는 구조를 제공한다. 이런 구조의 일원화는 개발을 단순화시킨다. 이런 단순화는 결국에는 오류 발생 빈도를 낮추고, 생산성 향상을 도와준다.</p>
<p>RxJS는 동기(Synchronous)와 비동기(Asynchronous)의 차이점을 <code>시간</code>이라는 개념을 도입함으로써 해결하려고했다.</p>
<p>대표적인 비동기(Asynchronous) 처리방식인 이벤트(Event)를 살펴보자.<br>Button에서 발생하는 click 이벤트를 처리하기 위해서는 다음과 같이 버튼에 이벤트 핸들러를 등록한다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">button.addEventListener(<span class="string">"click"</span>, event =&gt; &#123;</span><br><span class="line">  <span class="comment">// @todo</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>한번 이벤트 핸들러가 등록되면 사용자가 버튼을 눌렀을 때마다 등록된 이벤트 핸들러가 호출된다.<br>이런 과정에 <code>시간</code>이라는 개념을 도입함으로써 우리는 다른 시각을 얻을 수 있다.</p>
<p>버튼을 누르는 행위가 우리가 원하는 데이터라면 시간 축을 기준으로 이 데이터는 다음과 같은 모습을 보일 것이다.</p>
<img src="/blog/2017/06/30/rxjsbook1/async-time.png">

<p>이벤트가 아닌 동기(Synchronous) 방식인 함수호출도 <code>시간</code>이라는 개념을 도입하면 다음과 같이 표현될 수 있다.</p>
<img src="/blog/2017/06/30/rxjsbook1/sync-time.png">

<p>결국 동기와 비동기는 시간의 축으로 봤을때는 같은 형태인 것이다.<br>또한, 이런 형태는 <code>시간을 인덱스로 둔 컬렉션</code>으로 생각할 수도 있다. RxJS에서는 이를 <code>스트림(Stream)</code>이라 표현한다.</p>
<img src="/blog/2017/06/30/rxjsbook1/collection-time.png">

<p>RxJS에서는 이런 Stream을 표현하는 <code>Observable</code> 클래스를 제공한다.</p>
<h2 id="Observable"><a href="#Observable" class="headerlink" title="Observable"></a>Observable</h2><p>Observable은 <code>시간을 인덱스로 둔 컬렉션을 추상화한 클래스</code>이다.<br>이 클래스는 동기나 비동기의 동작 방식으로 전달된 데이터를 <code>하나의 컬렉션</code>으로 바라볼 수 있게 해준다.<br>이렇게 함으로써 개발자는 데이터가 어떤 형태로 전달되는지에 대해 더이상 고민할 필요가 없어진다.<br>단지, Observable을 통해 데이터를 전달 받기만 하면 된다.</p>
<blockquote>
<h5 id="Observable의-표준화"><a href="#Observable의-표준화" class="headerlink" title="Observable의 표준화"></a>Observable의 표준화</h5><p>RxJS의 Observable은 Rx에서 만든 라이브러리이기도 하지만, ECMAScript에 표준으로 제안된 스펙이기도하다.<br><a href="https://github.com/tc39/proposal-observable" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/tc39/proposal-observable</a></p>
<p>이 책에서 다루는 RxJS5는 ECMAScript에 제안된 표준 스펙을 기반으로 작성된 라이브러리이다.</p>
</blockquote>
<h2 id="모든-데이터는-Observable로-만들-수-있다"><a href="#모든-데이터는-Observable로-만들-수-있다" class="headerlink" title="모든 데이터는 Observable로 만들 수 있다."></a>모든 데이터는 Observable로 만들 수 있다.</h2><p>Observble은 모든 데이터를 다룬다.</p>
<ul>
<li>키보드를 눌러서 입력된 데이터</li>
<li>마우스를 이동하거나 클릭해서 입력된 데이터</li>
<li>Ajax/fetch 요청을 통해 얻은 데이터</li>
<li>Web socket을 통해 전달된 데이터</li>
<li>Message를 통해 전달된 데이터</li>
<li>…</li>
</ul>
<p></p>
                    
                        

                    
                    
                        <p>
                            <a href="/blog/2017/06/30/rxjsbook1/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/blog/2016/12/30/test-jsonp-using-sinonjs/">
                            Sinon으로 JSONP 테스트하기
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2016-12-30T08:30:05+09:00">
	
		    Dec 30, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/blog/categories/Tech/">Tech</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>예전 <a href="http://sculove.github.io/blog/2016/05/17/JavascriptTest/">JavaScript</a> 테스트 라는 글을 쓴적이 있는데, 그때 더 살펴봐야겠다라고 생각한 라이브러리가 Sinon.js이다.</p>
<p>최근에는 Jasmine 테스트 프레임워크가 괜찮아 보여 등안시 하다가, 기회가 되서 Sinon.js를 쓰게 되었다.  </p>
<img src="/blog/2016/12/30/test-jsonp-using-sinonjs/sinonjs.jpeg">

<p>Jasmine에서 Ajax를 mocking 하려면 <code>stubRequest</code>를 만들고 <code>andReturn</code>이라는 메소드를 이용하여 직관적으로 테스트 할 수 있다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jasmine.Ajax.stubRequest(<span class="string">"/another/url"</span>).andReturn(&#123;</span><br><span class="line">  responseText: <span class="string">"immediate response"</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>sinon도 있지 않을까 하는 마음으로 찾다가 결국 <code>yieldsTo</code> 라는 메소드를 찾았다.<br>원래는 jQuery ajax mocking 정도는 <a href="http://sinonjs.org/docs/#server" rel="external nofollow noopener noreferrer" target="_blank">useFakeXMLHttpRequest</a> 메소드를 이용하면 되지만,<br><a href="http://sinonjs.org/docs/#json-p" rel="external nofollow noopener noreferrer" target="_blank">JSONP인 경우</a>는 호출 방식이 다르기 때문에, useFakeXMLHttpRequest으로는 mocking이 어렵다.</p>
<h3 id="Sinon-js로-JSONP를-테스트-하려면…"><a href="#Sinon-js로-JSONP를-테스트-하려면…" class="headerlink" title="Sinon.js로 JSONP를 테스트 하려면…"></a>Sinon.js로 JSONP를 테스트 하려면…</h3><p>stub에게 callback을 호출하도록 시키는 <code>yieldsTo</code> 메소드를 이용하여, mocking 해야만 한다.<br>물론, <code>fakeServer</code> 를 이용하여 mocking 할수 있지만,<br><code>yieldsTo</code>가 훨<del>~</del>씬 간편하다.</p>
<p>코드는 다음과 같다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// beforeEach</span></span><br><span class="line"><span class="keyword">let</span> stub = sinon.stub(jQuery, <span class="string">"ajax"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Given</span></span><br><span class="line">stub.yieldsTo(<span class="string">"success"</span>, &#123; <span class="attr">param</span>: <span class="string">"데이터"</span>, <span class="attr">data</span>: <span class="string">"bla bla"</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// When</span></span><br><span class="line">jQuery.ajax(</span><br><span class="line">    url: <span class="string">"http://sculove.github.io"</span>,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">"callback"</span>) &#125;,</span><br><span class="line">    dataType: <span class="string">"jsonp"</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Then</span></span><br><span class="line">expect...</span><br><span class="line"></span><br><span class="line"><span class="comment">// afterEach</span></span><br><span class="line">stub.restore();</span><br></pre></td></tr></table></figure>

<p>주의할 것은 ajax를 실행하기 전에 이미 yieldsTo에 대한 정보를 미리 설정해놓아야 한다.</p>
<ul>
<li>Sinon.js API : <a href="http://sinonjs.org/docs/" rel="external nofollow noopener noreferrer" target="_blank">http://sinonjs.org/docs/</a></li>
<li>관련 이슈 : <a href="https://github.com/sinonjs/sinon/issues/41" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/sinonjs/sinon/issues/41</a></li>
</ul>

                    
                        

                    
                    
                        <p>
                            <a href="/blog/2016/12/30/test-jsonp-using-sinonjs/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/blog/2016/12/29/addEventListener-passive/">
                            addEventListener의 요상한 옵션들 중의 하나 Passive
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2016-12-29T15:23:24+09:00">
	
		    Dec 29, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/blog/categories/Tech/">Tech</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>iScroll contribution을 하다가 우연히 알게된 이슈가 있어 몇자 적어본다.</p>
<p>Chrome 49부터 <a href="https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md" rel="external nofollow noopener noreferrer" target="_blank">EventListenerOptions</a> 옵션을 지원한다.</p>
<p>기존 addEventListener의 3번째 파라미터로 캡쳐링/버블링 여부를 제어할 수 있는 부분이 <code>EventListenerOptions</code>이라는 객체형태의 추가 옵션을 받을수 있게 되었다.</p>
<p>jQuery를 쓸 이유가 하나씩 줄고 있다. 허허허</p>
<h5 id="EventListenerOptions-사용-전"><a href="#EventListenerOptions-사용-전" class="headerlink" title="EventListenerOptions 사용 전"></a>EventListenerOptions 사용 전</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.addEventListener(&apos;touchstart&apos;, handler, false);</span><br></pre></td></tr></table></figure>

<h5 id="EventListenerOptions-사용-후"><a href="#EventListenerOptions-사용-후" class="headerlink" title="EventListenerOptions 사용 후"></a>EventListenerOptions 사용 후</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">"touchstart"</span>, handler, &#123;</span><br><span class="line">  capture: <span class="literal">false</span>,</span><br><span class="line">  once: <span class="literal">false</span>,</span><br><span class="line">  passive: <span class="literal">false</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>현재 크롬에서 지원하는 EventListenerOptions 옵션은 다음과 같다.</p>
<ul>
<li>capture: 이벤트 캡쳐링 적용 여부. <a href="https://www.chromestatus.com/feature/5718574840676352" rel="external nofollow noopener noreferrer" target="_blank">크롬 49부터 지원</a></li>
<li>once: 이벤트를 한번만 호출하고 해제되는 옵션. <a href="https://developers.google.com/web/updates/2016/10/addeventlistener-once" rel="external nofollow noopener noreferrer" target="_blank">크롬 55부터 지원</a></li>
<li>passive: 스크롤 성능 향상을 위한 옵션으로 <code>true</code>일 경우, 스크롤을 위해 블록되는 것을 방지한다. 이 경우, <code>preventDefault</code>를 사용할 수 없다. <a href="https://developers.google.com/web/updates/2016/06/passive-event-listeners" rel="external nofollow noopener noreferrer" target="_blank">크롬 51부터 지원</a></li>
</ul>
<p>이 중, passive 속성은 성능향상을 위해, 브라우저의 기능을 프로그래밍으로 제어할수 있다.</p>
<h3 id="오"><a href="#오" class="headerlink" title="오~~"></a>오~~</h3><blockquote>
<p>passive 속성에 대한 링크<br><a href="https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md</a></p>
</blockquote>
<p>passive 속성이 <code>false</code>인 경우에 touchstart, touchmove와 같은 이벤트가 발생하면 preventDefault를 이용하여 실제 이벤트 자체를 막을 수 있기 때문에, 브라우저는 scroll을 계속 할지 안할지를 매번 감시해야만 한다.<br>하지만, passive 속성이 <code>true</code>일 경우에는 <code>preventDefault를 이용하여 scroll 이벤트를 막지 않겠다</code>고 브라우저에게 이야기하는 것과 같다. 따라서, 이 룰을 어기면 브라우저는 가차없이 다음과 같은 에러를 던진다.</p>


<p>다행이 passive 속성의 기본값은 <code>false</code> 이기 때문에, 기존 코드는 문제가 되지 않는다.</p>
<h2 id="하지만…"><a href="#하지만…" class="headerlink" title="하지만…"></a>하지만…</h2><p><code>Chrome 54+</code> 부터 EventListenerOptions의 passive 속성이 특별한 상황일 경우에는 기본값이 <code>true</code>로 설정된다.</p>
<blockquote>
<p>document또는 body에 이벤트 리스너를 추가할때, touchstart, touchmove와 같이 스크롤이 블록되는 이벤트인 경우, passive의 기본 속성값은 true가 된다.</p>
</blockquote>
<p>예를 들어 다음과 같은 코드는</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.addEventListener(</span><br><span class="line">  <span class="string">"touchmove"</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="literal">false</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>아래와 같은 무시무시한 에러가 발생한다.</p>


<p>혹시 이런 코드가 있으면 아래 같이 수정하시면 된다. 짜잔~!</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.addEventListener(</span><br><span class="line">  <span class="string">"touchmove"</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">  &#125;,</span><br><span class="line">  isPassive()</span><br><span class="line">    ? &#123;</span><br><span class="line">        capture: <span class="literal">false</span>,</span><br><span class="line">        passive: <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">    : <span class="literal">false</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>여기 사용한 isPassive 함수는 passive 속성 여부를 확인하는 유틸 함수이고, 상세 구현은 다음과 같다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPassive</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> supportsPassiveOption = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    addEventListener(</span><br><span class="line">      <span class="string">"test"</span>,</span><br><span class="line">      <span class="literal">null</span>,</span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">"passive"</span>, &#123;</span><br><span class="line">        <span class="keyword">get</span>: function() &#123;</span><br><span class="line">          supportsPassiveOption = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">  <span class="keyword">return</span> supportsPassiveOption;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://github.com/cubiq/iscroll/blob/master/demos/demoUtils.js#L2-L12" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/cubiq/iscroll/blob/master/demos/demoUtils.js#L2-L12</a></p>
<p>앞으로는 브라우저 내부를 점점 프로그램으로 제어할수 있는 API들이 쏟아질 것 같다.<br>웹개발을 하는 입장에서는 굉장히 좋은 방향성 같다.</p>

                    
                        

                    
                    
                        <p>
                            <a href="/blog/2016/12/29/addEventListener-passive/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/blog/2016/12/02/you-should-remove-consolelog/">
                            console.log를 지워야하는 이유
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2016-12-02T14:27:43+09:00">
	
		    Dec 02, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/blog/categories/Tech/">Tech</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>서비스 개발시에, 테스트용으로 console.log를 찍으시나요?<br>실수로 또는 의도적으로 실서비스에서도 이런 로그가 찍힐 수도 있는데요.</p>
<h3 id="테스트나-디버깅용으로-쓰는-이런-로그로-인해-실서비스에서는-메모리-릭이-발생할-수-있습니다"><a href="#테스트나-디버깅용으로-쓰는-이런-로그로-인해-실서비스에서는-메모리-릭이-발생할-수-있습니다" class="headerlink" title="테스트나 디버깅용으로 쓰는 이런 로그로 인해, 실서비스에서는 메모리 릭이 발생할 수 있습니다."></a>테스트나 디버깅용으로 쓰는 이런 로그로 인해, 실서비스에서는 메모리 릭이 발생할 수 있습니다.</h3><p>저도 우연히 개발 중에 알게되었답니다…</p>
<p>아래는 Observable 코드를 1000개 만드는 코드입니다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeObservable</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Rx.Observable.generate(</span><br><span class="line">    performance.now(),</span><br><span class="line">    x =&gt; x &lt;= startTime + duration,</span><br><span class="line">    x =&gt; performance.now(),</span><br><span class="line">    x =&gt; (x - startTime) / duration,</span><br><span class="line">    Rx.Scheduler.animationFrame</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onMemory</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"create observable"</span>, i, makeObservable());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>demo link : <a href="http://jsbin.com/hohoxifipu/1" rel="external nofollow noopener noreferrer" target="_blank">http://jsbin.com/hohoxifipu/1</a></p>
<p>makeObservable()을 통해 instance를 반환하고, onMemory에서 1000번 반복합니다.<br>코드 상으로는 instance 변수가 사용되지 않기 때문에, <code>메모리가 정상적으로 릴리즈 되어야합니다.</code></p>
<p>하지만, 결과는 다음과 같이 메모리 릭이 발생합니다.</p>
<img src="/blog/2016/12/02/you-should-remove-consolelog/before.png">

<img src="/blog/2016/12/02/you-should-remove-consolelog/memoryleak.png">

<p>보시는 바와 같이 System Object가 굉장히 많이 증가하는 것을 보실 수 있습니다.</p>
<h3 id="이유는-바로-console-log-때문입니다"><a href="#이유는-바로-console-log-때문입니다" class="headerlink" title="이유는 바로 console.log 때문입니다."></a>이유는 바로 console.log 때문입니다.</h3><p>저도 이슈 문의했다가 알게된 사항입니다.</p>
<p><a href="https://github.com/ReactiveX/rxjs/issues/2090#issuecomment-256844948" rel="external nofollow noopener noreferrer" target="_blank"><img src="/blog/2016/12/02/you-should-remove-consolelog/bingo.png"></a></p>
<blockquote>
<p>Chrome Devtool에서 정보를 표현하기 위해,<br>console.log를 사용할때 내부적으로 reference를 저장하게 된답니다.<br>그래서, 결국은 메모리가 해제되지 않고. 메모리 릭이 발생하게 됩니다.</p>
</blockquote>
<p>실제로 console.log만 지워보았습니다.</p>
<p>짜잔~!</p>
<img src="/blog/2016/12/02/you-should-remove-consolelog/after.png">

<p>메모리가 정상적으로 릴리즈되는 것을 확인 할수 있습니다.</p>
<h2 id="우리-모두-서비스에서-찍는-console-log…-꼭-지웁시다"><a href="#우리-모두-서비스에서-찍는-console-log…-꼭-지웁시다" class="headerlink" title="우리 모두 서비스에서 찍는 console.log…. 꼭! 지웁시다~ ^^"></a>우리 모두 서비스에서 찍는 console.log…. 꼭! 지웁시다~ ^^</h2>
                    
                        

                    
                    
                        <p>
                            <a href="/blog/2016/12/02/you-should-remove-consolelog/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/blog/2016/12/02/improve-angular1-digestloop/">
                            Angular1 Digest Loop 개선하기
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2016-12-02T13:55:20+09:00">
	
		    Dec 02, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/blog/categories/Tech/">Tech</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>Angular1은 높은 생산성을 갖는 좋은 프레임워크이긴 하지만, 성능 부분은 아쉬운 점이 많이 있습니다.<br>그 중 하나로, 데이터 동기화를 처리하는 <code>Digest Loop</code>에 대한 이야기를 많이 합니다.<br>아쉽지만, 이 부분은 Angular1을 만들때 챙기지 못한 부분 중에 하나죠.</p>
<p>이 부분에 대한 튜닝 가이드는 지금까지 굉장히 정리가 잘된 자료 들이 많이 있습니다.</p>
<ul>
<li><a href="https://www.alexkras.com/11-tips-to-improve-angularjs-performance/" rel="external nofollow noopener noreferrer" target="_blank">https://www.alexkras.com/11-tips-to-improve-angularjs-performance/</a></li>
<li><a href="https://speakerdeck.com/avivby/angular-performance-101" rel="external nofollow noopener noreferrer" target="_blank">https://speakerdeck.com/avivby/angular-performance-101</a></li>
</ul>
<h3 id="하지만-정작-Digest-문제가-발생했을-때-어떻게-찾아야하는-지에-대한-이야기는-아쉽지만-아무도-이야기-해주지-않습니다"><a href="#하지만-정작-Digest-문제가-발생했을-때-어떻게-찾아야하는-지에-대한-이야기는-아쉽지만-아무도-이야기-해주지-않습니다" class="headerlink" title="하지만, 정작 Digest 문제가 발생했을 때, 어떻게 찾아야하는 지에 대한 이야기는 아쉽지만 아무도 이야기 해주지 않습니다."></a>하지만, 정작 Digest 문제가 발생했을 때, 어떻게 찾아야하는 지에 대한 이야기는 아쉽지만 아무도 이야기 해주지 않습니다.</h3><p>우선 FE좀 해본 개발자라면, 성능 문제가 발생했을 때,<br>크롬의 DevTool을 열고, Timeline을 열어서 문제의 원인을 찾으려고 합니다.</p>
<p>짜잔. 다음과 같습니다.</p>
<img src="/blog/2016/12/02/improve-angular1-digestloop/hell.png">

<p>해당 서비스 개발자가 봐도 이 많은 호출 스택에서 뭐가 문제인지를 찾아내기는 쉽지가 않습니다.<br>더군다나 저같이 잠시 지원한 입장에서 Timeline만을 갖고 이 문제의 원인을 찾기는 정말 쉬운 문제가 아닙니다.<br>단지, “Digest Loop가 많이 도는 구나” 정도를 알수는 있겠죠.</p>
<h3 id="Digest-Loop"><a href="#Digest-Loop" class="headerlink" title="Digest Loop"></a>Digest Loop</h3><p>Angular의 Digest Loop는 Watcher 수와 Watcher Expression의 수행시간에 비례합니다.</p>
<blockquote>
<p>Digest Loop = Wacher 수 * Wacher Expression 호출 시간</p>
</blockquote>
<h4 id="따라서-Digest-Loop에-의해-성능-문제가-발생했을때-이를-해결하는-방법은-크게-3가지-입니다"><a href="#따라서-Digest-Loop에-의해-성능-문제가-발생했을때-이를-해결하는-방법은-크게-3가지-입니다" class="headerlink" title="따라서, Digest Loop에 의해 성능 문제가 발생했을때 이를 해결하는 방법은 크게 3가지 입니다."></a>따라서, Digest Loop에 의해 성능 문제가 발생했을때 이를 해결하는 방법은 크게 3가지 입니다.</h4><ol>
<li>Watcher 수를 줄이는 방법</li>
<li>Watcher Expression 호출 시간을 줄이는 방법</li>
<li>Digest Loop를 호출 수를 줄이는 방법</li>
</ol>
<p>물론, Angular1의 <a href="https://chrome.google.com/webstore/detail/angularjs-batarang/ighdmehidhipcmcojjgiloacoafjmpfk" rel="external nofollow noopener noreferrer" target="_blank">Batarang</a> 을 이용하여, Digest Loop가 어떻게 도는지 확인 할 수는 있습니다.<br>아래 보시는 것 처럼, <code>얼마나 많이 발생하고, 어떤 Watcher Expression이 많이 도는지는 확인 할수 있습니다.</code></p>
<img src="/blog/2016/12/02/improve-angular1-digestloop/batarang1.png">
<img src="/blog/2016/12/02/improve-angular1-digestloop/batarang2.png">

<h3 id="그런데-정작-이렇게-많이-발생하는-Digest-Loop가-어디서-발생하는지를-찾아내는-방법은-없습니다"><a href="#그런데-정작-이렇게-많이-발생하는-Digest-Loop가-어디서-발생하는지를-찾아내는-방법은-없습니다" class="headerlink" title="그런데, 정작, 이렇게 많이 발생하는 Digest Loop가 어디서 발생하는지를 찾아내는 방법은 없습니다."></a>그런데, 정작, 이렇게 많이 발생하는 Digest Loop가 어디서 발생하는지를 찾아내는 방법은 없습니다.</h3><h2 id="Digest-Loop를-유발하는-곳-손쉽게-찾는-방법"><a href="#Digest-Loop를-유발하는-곳-손쉽게-찾는-방법" class="headerlink" title="Digest Loop를 유발하는 곳 손쉽게 찾는 방법"></a>Digest Loop를 유발하는 곳 손쉽게 찾는 방법</h2><p>Angular는 기본적으로 <code>비동기 시점이 종료되는 시점</code>에 digest가 호출됩니다.<br>따라서, <code>Ajax call이 발생하는 부분, timeout/interval이 종료되는 부분, ng-click과 같이 사용자 이벤트</code>가 호출되는 부분에서 digest loop가 호출됩니다.</p>
<p>사용자 이벤트가 호출되는 부분은 사용자가 명시적으로 하는 행위이기 때문에, 발생시점과 발생하는 곳을 가급적 쉽게 찾을수 있습니다.<br>다만, Ajax call 이나, timeout/interval은 코드에 녹아 있기 때문에, 찾기가 쉽지 않습니다.</p>
<p>이를 쉽게 확인하는 방법은 사실 간단합니다.<br>바로, Angular 소스 코드에서 Digest Loop가 발생하는 시점에 <a href="https://developers.google.com/web/tools/chrome-devtools/console/console-reference" rel="external nofollow noopener noreferrer" target="_blank">크롬 로그</a>를 찍는 방법입니다.<br>단순 로그 출력이지만, 그 효과는 큽니다.</p>
<ol>
<li>크롬에서 console.trace 로그를 찍으면 다음과 같이 호출 스택을 확인할 수 있으며, <code>해당 소스로의 이동이 가능</code>합니다.  <img src="/blog/2016/12/02/improve-angular1-digestloop/trace.png"></li>
<li>크롬에서 function 을 로그로 찍으면 <code>해당 소스로의 이동이 가능</code>합니다.  <img src="/blog/2016/12/02/improve-angular1-digestloop/moveTosource.gif"></li>
<li>크롬에서 console.time/timeEnd를 사용하시면, Timeline 탭에서 로그를 확인 할수 있습니다.  <img src="/blog/2016/12/02/improve-angular1-digestloop/consoletime.png"></li>
<li>크롬에서 console.count를 사용할 경우, 몇번 호출되었는지 로그를 통해 알수 있습니다.<img src="/blog/2016/12/02/improve-angular1-digestloop/consolecount.png">

</li>
</ol>
<h2 id="Angular-1-5-8-로그-추가-버전"><a href="#Angular-1-5-8-로그-추가-버전" class="headerlink" title="Angular 1.5.8 로그 추가 버전"></a>Angular 1.5.8 로그 추가 버전</h2><p>능력 부족과 시간 부족으로 툴은 못 만들었지만, Angular 1.5.8 소스에 로그를 찍어 봤습니다.<br><a href="angular.js.1.5.8.zip">angular.js.1.5.8.zip</a></p>
<p>개발시에 Angular.js 파일을 교체하시면 크롬 콘솔에서 로그를 바로 확인할 수 있습니다.</p>
<img src="/blog/2016/12/02/improve-angular1-digestloop/result.png">

<p>그 외 angular 버전에 적용하시려면 다음 코드 조각을 참조하시기 바랍니다.</p>
<h4 id="ajax-httpProvider를-이용"><a href="#ajax-httpProvider를-이용" class="headerlink" title="ajax - $httpProvider를 이용"></a>ajax - $httpProvider를 이용</h4><p>Ajax의 경우 Angular 코드에 로그를 삽입하는게 아니라, HTTP interceptor를 등록해서 호출 여부를 확인할 수 있습니다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$httpProvider.useApplyAsync(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// HTTP 인터셉터</span></span><br><span class="line">$httpProvider.interceptors.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    request: <span class="function"><span class="keyword">function</span>(<span class="params">request</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.time(<span class="string">"[http] "</span>, request.url);</span><br><span class="line">      <span class="keyword">return</span> request;</span><br><span class="line">    &#125;,</span><br><span class="line">    response: <span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.timeEnd(<span class="string">"[http] "</span> + response.config.url);</span><br><span class="line">      <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="timeout-angular-소스-수정"><a href="#timeout-angular-소스-수정" class="headerlink" title="timeout - angular 소스 수정"></a>timeout - angular 소스 수정</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeout</span>(<span class="params">fn, delay, invokeApply</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//... 생략</span></span><br><span class="line">  timeoutId = $browser.defer(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// [Start] $timeout에 의해 rootScope.apply가 호출된 경우</span></span><br><span class="line">      !skipApply &amp;&amp; <span class="built_in">console</span>.warn(<span class="string">"from timeout"</span>, fn, delay);</span><br><span class="line">      <span class="comment">// [End] $timeout에 의해 rootScope.apply가 호출된 경우</span></span><br><span class="line">      deferred.resolve(fn.apply(<span class="literal">null</span>, args));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      deferred.reject(e);</span><br><span class="line">      $exceptionHandler(e);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="keyword">delete</span> deferreds[promise.$$timeoutId];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!skipApply) $rootScope.$apply();</span><br><span class="line">  &#125;, delay);</span><br><span class="line">  <span class="comment">//... 생략</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="interval-angular-소스-수정"><a href="#interval-angular-소스-수정" class="headerlink" title="interval - angular 소스 수정"></a>interval - angular 소스 수정</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function interval(fn, delay, count, invokeApply) &#123;</span><br><span class="line">  //...생략</span><br><span class="line">  function callback() &#123;</span><br><span class="line">    // [Start] $interval에 의해 rootScope.apply가 호출된 경우</span><br><span class="line">    !skipApply &amp;&amp; console.warn(&quot;from interval&quot;, fn, delay);</span><br><span class="line">    // [End] $interval에 의해 rootScope.apply가 호출된 경우</span><br><span class="line">    if (!hasParams) &#123;</span><br><span class="line">      fn(iteration);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      fn.apply(null, args);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="digest-함수-angular-소스-수정"><a href="#digest-함수-angular-소스-수정" class="headerlink" title="digest 함수 - angular 소스 수정"></a>digest 함수 - angular 소스 수정</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$digest: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// [Start] $digest가 호출된 경우</span></span><br><span class="line">  <span class="built_in">console</span>.trace(<span class="string">"digest trace"</span>);</span><br><span class="line">  <span class="built_in">console</span>.time(<span class="string">"digest time"</span>);</span><br><span class="line">  <span class="comment">// [End] $digest가 호출된 경우</span></span><br><span class="line">  beginPhase(<span class="string">'$digest'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//... 생략</span></span><br><span class="line">  <span class="keyword">do</span> &#123; <span class="comment">// "while dirty" loop</span></span><br><span class="line">    <span class="comment">//... 생략</span></span><br><span class="line">    <span class="keyword">do</span> &#123; <span class="comment">// "traverse the scopes" loop</span></span><br><span class="line">      <span class="comment">//... 생략</span></span><br><span class="line">    &#125; <span class="keyword">while</span> ((current = next));</span><br><span class="line">  &#125; <span class="keyword">while</span> (dirty || asyncQueue.length);</span><br><span class="line"></span><br><span class="line">  clearPhase();</span><br><span class="line">  <span class="comment">// [Start] $digest가 호출된 count 확인</span></span><br><span class="line">  <span class="built_in">console</span>.timeEnd(<span class="string">"digest time"</span>);</span><br><span class="line">  <span class="built_in">console</span>.count(<span class="string">"[Digest count]"</span>);</span><br><span class="line">  <span class="comment">// [End] $digest가 호출된 count 확인</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


                    
                        

                    
                    
                        <p>
                            <a href="/blog/2016/12/02/improve-angular1-digestloop/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/blog/2016/11/19/rxjs-apply2/">
                            Rxjs-활용기2
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2016-11-19T21:23:23+09:00">
	
		    Nov 19, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/blog/categories/Tech/">Tech</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>Deview2016 <a href="https://deview.kr/2016/schedule#session/137" rel="external nofollow noopener noreferrer" target="_blank">Angular2 VS React, React VS Angular2</a> 발표에서도<br>RxJS를 언급했지만, 지금까지도, <code>RxJS를 왜 Angular2가 도입했는가</code>에 대한 이유는 모르겠다.</p>
<p>이를 알아보기 위해,<br>Angular2 프로젝트를 하면서, RxJS를 가급적 많이 사용하고 있는데,<br>그 중 하나 느낀 점이 있어 몇자 끄적여 본다.</p>
<h3 id="왜-Angular2는-RxJS를-도입했는가"><a href="#왜-Angular2는-RxJS를-도입했는가" class="headerlink" title="왜 Angular2는 RxJS를 도입했는가?"></a>왜 Angular2는 RxJS를 도입했는가?</h3><p>일반적으로 Angular2를 사용하게 되면, 화면에 표현되는 요소는 Component로 만들고,<br>실제 데이터를 가져오는 작업은 Service에서 담당한다.<br>이 둘의 관계를 RxJS의 Observable 객체를 통해 subscribe로 연결된다.<br>좀 간단히 보면, 다음 그림과 같다.</p>
<img src="/blog/2016/11/19/rxjs-apply2/component_service.png">

<p>Component와 Service 간의 구조에서 RxJS는 둘 사이를 이어주는 다리가 되고,<br>단방향의 데이터를 가져오는데 결합도가 약하게 연결된다.</p>
<p>이 말을 좀 풀어서 쓰면,<br>Component에서는 Service를 DI(Dependency Injection)로 주입받고,<br>주입된 상태에서 데이터를 가져오는 것은 Observable 객체로 연결이 된다는 말이다.<br>이렇게 되면 Component 입장에서는 주입된 Service의 메소드(foo)만 알면 된다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@Component(&#123;&#125;)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// DI로 service 주입</span></span><br><span class="line">  construnctor(service: Service) &#123;</span><br><span class="line">    <span class="keyword">this</span>.service</span><br><span class="line">      .foo()</span><br><span class="line">      <span class="comment">// operator 적용</span></span><br><span class="line">      <span class="comment">// filter(...)</span></span><br><span class="line">      <span class="comment">// map(...)</span></span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      .subscribe(<span class="function"><span class="params">x</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 데이터를 받음.</span></span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Injectable()</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Service</span> </span>&#123;</span><br><span class="line">  foo(): Observable &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>또한, Service에서는 Component와의 연결을 Observable로 사용하기 위해, 메소드의 반환값을 Observable로 사용한다.<br>반환값이 Observable이기 때문에, RxJS의 operator를 적용하면, Service가 주는 데이터를 변경하거나, 무시하거나, 기타 등등의 작업들을 Component가 할 수 있다.</p>
<blockquote>
<p>즉, Angular2에서 RxJS를 사용하면 Component가 갑이되고, Service가 을이 되는 것이다.</p>
</blockquote>
<p>예전에는 Service가 주는 데이터만 가지고 처리했다면, 이제는 Component가 데이터의 처리를 결정할수 있게 된 것이다.<br>흔히 이를 <code>Push방식</code>의 장점이라고 이야기 한다.</p>
<p>그럼 RxJS를 사용하면, 단순히 갑과 을의 관계가 바꿔서 좋다는 말인가? 좋긴하다.<br>하지만, 그렇다고 이게 RxJS를 사용하는 이유라고 보기에는 납득이 안된다.<br>더 해봐야겠다.</p>
<h2 id="RxJS와-Typescript-의-캐미"><a href="#RxJS와-Typescript-의-캐미" class="headerlink" title="RxJS와 Typescript 의 캐미"></a>RxJS와 Typescript 의 캐미</h2><p>Angular2프로젝트를 하면서 확실하게 안 사실이 있다.<br>바로 RxJS와 Typescript의 캐미(chemi)이다.</p>
<p>프로젝트를 하다보면 알겠지만, 앞에서 보여준 그림처럼 Component와 Service간의 관계가 1:1인 상황은 많지 않다.<br>하나의 Component에서 여러개의 Service를 사용하기도 하고, 하나의 Service와 여러개의 Component가 연결되어 있기도 하다.<br>또한, Service에서 다른 Service와 연결되어 있기도 한다.</p>
<img src="/blog/2016/11/19/rxjs-apply2/complex.png">

<p>Component와 Service간에는 항상 데이터들이 흐르게 되는데. 이때 전달되는 데이터를 따라가기는 쉽지 않다.<br>물론, 오늘 개발한 코드라면 아주 쉽게 따라 갈수 있겠지만,<br>개발한 코드가 몇 달 전이거나, 내가 아닌 다른 이가 개발한 코드라면, 데이터 흐름을 따라가는 것은 쉬운일이 아니다.</p>
<p>하지만, 우리는 개발자이니깐 이런 것쯤은 충분히 이겨낼수 있다고 생각한다.<br>왜? 우린 프로니깐 ㅋㅋ</p>
<p>그런데 문제는 RxJS로 연결 될 경우, 이 Operator에 의해 중간 중간 전달되는 데이터가 변형이 된다는 것이다.<br>바로, 이런식으로…</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.service</span><br><span class="line">  .foo()</span><br><span class="line">  .map(<span class="function"><span class="params">x</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> somthingFn(x);</span><br><span class="line">  &#125;)</span><br><span class="line">  .subscribe(<span class="function"><span class="params">x</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 데이터를 받음.</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>만약, Javascript의 역량을 최대한으로 끌어올려서 데이터를 간결하게(?) 변형(?) 시킨다면,<br>무슨 데이터가 왔는지 또는 넘겨진 데이터의 속성이 무었인지 확인하기가 어렵다.</p>
<p>하지만. RxJS와 Typescript가 만나면 상황은 좀 달라진다.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.service</span><br><span class="line">  .foo()</span><br><span class="line">  .map(<span class="function">(<span class="params">x: Student</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> somthingFn(x);</span><br><span class="line">  &#125;)</span><br><span class="line">  .subscribe(<span class="function">(<span class="params">x: SmartStudent</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 데이터를 받음.</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>Student 데이터를 받아서, SmartStudent 데이터로 변경했다는 것을 알 수 있다.<br>한 눈에 데이터가 어떻게 변했는지바로 확인 가능하다.<br>만약, vscode와 같은 훌륭한 IDE툴이 있다면.데이터의 속성이 또 어떤 것인지 바로 파악할수 있다.</p>
<blockquote>
<p>그래서 만약, RxJS를 사용한다면, 꼭! Typescript와 함께하는 걸 추천한다.</p>
</blockquote>
<p>Angular2가 RxJS를 왜 도입했는지에 대해서는 아직도 잘 모르겠다.<br>하지만, Typescript와 RxJS의 캐미가 정말 짱 좋다는 사실은 확인했다.</p>
<p>분명, RxJS와 Angular2의 캐미도 확인할 수 있으니라 본다.ㅋㅋ</p>

                    
                        

                    
                    
                        <p>
                            <a href="/blog/2016/11/19/rxjs-apply2/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/blog/2016/11/14/after-angular-release/">
                            Angular2 정식이후, 지금까지 정리
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2016-11-14T20:30:21+09:00">
	
		    Nov 14, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/blog/categories/Tech/">Tech</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>오늘은 Angular2 정식릴리즈 이후, 지금까지 어떻게 변해 왔고, 앞으로 어떻게 변할지에 대해 간단히 살펴보자.</p>
<h2 id="Release"><a href="#Release" class="headerlink" title="Release"></a>Release</h2><p>Angular2는 2016년 9월 14일 이후, 지금까지 꾸준한 업데이트로 빠르게 변해가고 있다. 총 4번의 patch가 이루어졌으며, 1번의 minor 버전이 업데이트 되었다. 현재는 2번째 minor 업데이트가 진행 중에 있다.</p>
<ul>
<li>2.0.0 릴리즈 (2016.09.14)</li>
<li>2.0.1 릴리즈 (2016.09.23)</li>
<li>2.0.2 릴리즈 (2016.10.05)</li>
<li>2.1.0 릴리즈 (2016.10.12)</li>
<li>2.1.1 릴리즈, 2.2.0-beta.0 (2016.10.20)</li>
<li>2.1.2 릴리즈, 2.2.0-beta.1 (2016.10.27)</li>
<li>2.2.0-rc0 (2016.11.02)</li>
</ul>
<p>이렇게 Angular2가 빠르게 발전해 나가고 있는 이유 중에 하나는 중소기업에 버금가는 막대한 인력이 이 프로젝트를 진행하고 있기 때문이다.</p>
<p>Angular의 창시자 Miško Hevery 외에 6명의 리더가 존재하고, 25명의 구글러가 개발자로 있다. 더불어, 30명의 커뮤니티 인력이 주요 개발자로 포진해 있다. 그 외에도 300여명의 Contributer가 github 상에 존재한다.<br><a href="https://angular.io/about/" rel="external nofollow noopener noreferrer" target="_blank">https://angular.io/about/</a></p>
<img src="/blog/2016/11/14/after-angular-release/angular.png">

<p>이를 경제적인 가치(?)로 환산한다면, 어마어마한 금액이 될 것으로 보인다.<br>돈도 될 것 같지 않은 FE 프레임워크에 왜 구글은 이렇게 막대한 자원을 투입하고 있을까? 구글입장에서는 푼돈인 건가? 아니면, 무슨 심오한 뜻이 있지 않을까?</p>
<p>Android OS와 같은 플랫폼 전쟁을 FE에서도 하려는 것인가?<br>우매한 나로서는 당췌 모르겠다. ㅠㅠ</p>
<p>하지만, 푼돈이 아니라면…아마 구글이 Angular2에 기대하는 바는 굉장히 클 것으로 보인다.<br>실제 그 꿈은 실로 원대하다.</p>
<h2 id="Release-정책"><a href="#Release-정책" class="headerlink" title="Release 정책"></a>Release 정책</h2><p>Angular는 정식 버전을 공개하면서, 프레임워크 운영 정책에 대한 이야기도 함께 공개를 했다.<br><a href="http://angularjs.blogspot.kr/2016/10/versioning-and-releasing-angular.html?view=classic" rel="external nofollow noopener noreferrer" target="_blank">http://angularjs.blogspot.kr/2016/10/versioning-and-releasing-angular.html?view=classic</a></p>
<p>우선, Angular2의 버전 규칙을 기본적으로 Semantic Versioning(<code>MAJOR.MINOR.PATCH</code>)을 사용하기로 하였다. 더불어, 6개월 단위로 Major 업그레이드를 한다고 공개했다.<br>이 말은, 6개월 마다 Angular3, Angular4, Angular5를 내놓겠다는 이야기이다.</p>
<p>아 갑자기 머리가 아프다.</p>
<h4 id="Angular1에서-Angular2로-왔더니-다시-3-4-5-…을-내-놓겠다고"><a href="#Angular1에서-Angular2로-왔더니-다시-3-4-5-…을-내-놓겠다고" class="headerlink" title="Angular1에서 Angular2로 왔더니 다시, 3,4,5,…을 내 놓겠다고?"></a>Angular1에서 Angular2로 왔더니 다시, 3,4,5,…을 내 놓겠다고?</h4><p>하지만, 그렇게 걱정하지 않아도 된다. React는 0.14.0에서 15.0.0으로 바꾸지 않았던가? Angular2도 3,4,5의 연장선에 있기 때문에 새로운 것이 아니다.</p>
<img src="/blog/2016/11/14/after-angular-release/angular-version.png">

<p>또한, 릴리즈도 정말 쉬지 않고 계속한다. 매주 patch 릴리즈를 하고, 3개월 동안 3번의 minor 릴리즈를 하고, 이후 2달 간은 1개의 major 릴리즈를 한다.</p>
<img src="/blog/2016/11/14/after-angular-release/angular-release.png">

<h2 id="앞으로의-방향성"><a href="#앞으로의-방향성" class="headerlink" title="앞으로의 방향성"></a>앞으로의 방향성</h2><p>앞으로 Angular는 다음 작업들에 집중한다고 공개했다.<br><a href="http://angularjs.blogspot.kr/2016/09/angular2-final.html?view=classic" rel="external nofollow noopener noreferrer" target="_blank">http://angularjs.blogspot.kr/2016/09/angular2-final.html?view=classic</a></p>
<ul>
<li>안전성 향상, 가이드와 예제 보강,</li>
<li>Angular : Animation 작업 진행,</li>
<li>WebWorker Experimental API를 Stable화 하는 작업</li>
<li>Angular Material2, Angular Universal에 대한 개발 진행</li>
<li>성능 향상, 모듈 경량화<blockquote>
<p>최근 Angular3에 대한 기사에서는 강력한 IDE 지원과 25% 감소된 템플릿 코드를 생산한다고 이야기 하고 있다.<br><a href="http://www.infoworld.com/article/3139891/javascript/angular-3-is-hot-on-the-heels-of-angular-2.html" rel="external nofollow noopener noreferrer" target="_blank">http://www.infoworld.com/article/3139891/javascript/angular-3-is-hot-on-the-heels-of-angular-2.html</a></p>
</blockquote>
</li>
</ul>
<h4 id="그래서…"><a href="#그래서…" class="headerlink" title="그래서…"></a>그래서…</h4><p>현재 구글의 행보로 앞으로를 추측해 본다면, Angular2의 갈길은 아직 멀어 보인다. 또한, 그 앞날을 예측하기는 더더구나 어려워 보인다.</p>
<p>하지만, Angular1과 같이 자사 서비스에 쓰지 않는 프레임워크를 만들고 있는 것 같지는 않다. 이번에는 꼭! 구글에서 쓰는 프레임워크를 만들려는 확고한 의지가 보인다.</p>

                    
                        

                    
                    
                        <p>
                            <a href="/blog/2016/11/14/after-angular-release/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/blog/2016/11/04/rxjs-apply1/">
                            Rxjs 활용기1
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2016-11-04T11:14:26+09:00">
	
		    Nov 04, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/blog/categories/Tech/">Tech</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>RxJS를 협업 아닌 협업에서 조금씩 쓰고 있다.<br>오버엔지니어링이라는 생각을 떨쳐버릴 수 없지만, 또 한편으로는 꽤 괜찮다라는 느낌 또한 든다.</p>
<blockquote>
<p>현실적인 활용도와 이상적인 개념 사이에서 줄다리기를 하고 있는 느낌이다.</p>
</blockquote>
<p>지금은 RxJS의 활용도를 직접 검증도 해보고 싶은 마음도 있고,<br>간만에 느끼는 개발의 재미도 맛볼 수 있는 영역이라 그 끈을 놓지 않고 있다.</p>
<h2 id="distinctUntilChanged-너는-누구냐"><a href="#distinctUntilChanged-너는-누구냐" class="headerlink" title="distinctUntilChanged 너는 누구냐?"></a>distinctUntilChanged 너는 누구냐?</h2><p>RxJS의 operator중에 흔하게 쓰이는 <code>distinctUntilChanged</code> 메소드에 대한 약간의 소감을 적어보려고 한다.</p>
<img src="/blog/2016/11/04/rxjs-apply1/distinctUntilChanged.png">
<p><a href="http://rxmarbles.com/#distinctUntilChanged" rel="external nofollow noopener noreferrer" target="_blank">http://rxmarbles.com/#distinctUntilChanged</a></p>
<p>우선 이 함수는 우리가 프로그래밍을 할때 항상 고민하는 일.<br>중복호출? 중복 전달 등에 대한 문제를 아주 손쉽게 해결해 준다.</p>
<p>distinctUntilChanged 함수는 기본적으로 distinctUntilChanged()를 호출해서 사용 할 수 있다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Rx.Observable.of(<span class="number">10</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="number">30</span>)</span><br><span class="line">  .distinctUntilChanged()</span><br><span class="line">  .subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x));</span><br></pre></td></tr></table></figure>

<p>결과는 예상했던 것처럼, <code>10, 30</code> 만 나온다. 좋다. 쉽다!</p>
<h2 id="Rxjs-버전마다-달라요"><a href="#Rxjs-버전마다-달라요" class="headerlink" title="Rxjs 버전마다 달라요~"></a>Rxjs 버전마다 달라요~</h2><p>하지만, 다음과 같은 코드인 경우, rxjs의 버전에 따라 다르게 동작한다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Rx.Observable.of(&#123; <span class="attr">value</span>: <span class="number">10</span> &#125;, &#123; <span class="attr">value</span>: <span class="number">30</span> &#125;, &#123; <span class="attr">value</span>: <span class="number">30</span> &#125;, &#123; <span class="attr">value</span>: <span class="number">30</span> &#125;)</span><br><span class="line">  .distinctUntilChanged()</span><br><span class="line">  .subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x));</span><br></pre></td></tr></table></figure>

<p>위의 코드는 rxjs4에서는 정상 동작하지만, rxjs5에서는 primitive 타입이 아닌 경우에는 정상적으로 동작하지 않는다. 된장!</p>
<h2 id="이렇게-되는-이유는-rxjs의-기본-compare-함수가-rxjs4와-rxjs5가-다르기-때문이다"><a href="#이렇게-되는-이유는-rxjs의-기본-compare-함수가-rxjs4와-rxjs5가-다르기-때문이다" class="headerlink" title="이렇게 되는 이유는 rxjs의 기본 compare 함수가 rxjs4와 rxjs5가 다르기 때문이다."></a>이렇게 되는 이유는 rxjs의 기본 compare 함수가 rxjs4와 rxjs5가 다르기 때문이다.</h2><p>rxjs4의 기본 compare함수는 다음과 같다.</p>
<blockquote>
<p><a href="https://github.com/Reactive-Extensions/RxJS/blob/master/dist/rx.all.js#L554-L562" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/Reactive-Extensions/RxJS/blob/master/dist/rx.all.js#L554-L562</a></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">baseIsEqual</span>(<span class="params">value, other, ...</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (value === other) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (value == <span class="literal">null</span> || other == <span class="literal">null</span> || (!isObject(value) &amp;&amp; !isObjectLike(other))) &#123;</span><br><span class="line">    <span class="keyword">return</span> value !== value &amp;&amp; other !== other;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> baseIsEqualDeep(value, other, baseIsEqual, ...);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>기본적으로 값이나 reference 값을 비교하고, 만약, reference 값이 같다면, 깊은 탐색을 한다.</p>
<p>반면, rxjs5의 기본 compare 함수는 다음과 같다.</p>
<blockquote>
<p><a href="https://github.com/ReactiveX/rxjs/blob/master/src/operator/distinctUntilChanged.ts#L53-L55" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/ReactiveX/rxjs/blob/master/src/operator/distinctUntilChanged.ts#L53-L55</a></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">private compare(x: any, <span class="attr">y</span>: any): boolean &#123;</span><br><span class="line">    <span class="keyword">return</span> x === y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>값이나 reference 값을 비교하는 간단한 함수이다.</p>
<p>이렇게 한 이유는 rxjs5가 추구하는 <code>Better performance</code>를 위한 조치로 보인다. 하지만…. 사용자는 헷갈린다.</p>
<p>그래서 rxjs5에서는 primitive 타입이 아닌 경우에는 immutable한 객체를 데이타로 활용 해야 효과적이다.</p>
<blockquote>
<p>즉, 객체의 reference가 변경되면, 값이 변경되었고, 그렇지 않으면 변경되지 않았다는 대전제가 수반되어야한다.</p>
</blockquote>
<p>객체를 매번 immutable하게 만들려고 하면 결국에는 복사라는 <code>불필요한 과정</code>을 거쳐야만 한다. 비교하고자 하는 객체가 크면 클수록 그 비용은 더 크다.<br>모델 자체가 간단할 때는 크게 문제가 되지 않는다. 하지만, 좀 큰 모델 객체가 변경되었을 때는 어떻게 하는게 좋을까?<br>물론, <a href="https://facebook.github.io/immutable-js/" rel="external nofollow noopener noreferrer" target="_blank">immutable.js</a> 같은 라이브러리를 사용해서 그 비용을 줄있 수는 있다.<br>하지만, 역시 비용은 비용이다.</p>
<h2 id="distinctUntilChanged를-잘-사용해보자"><a href="#distinctUntilChanged를-잘-사용해보자" class="headerlink" title="distinctUntilChanged를 잘 사용해보자."></a>distinctUntilChanged를 잘 사용해보자.</h2><p>rxjs5의 distinctUntilChanged는 compare함수와 keySelector 함수를 파라미터로 받아 들어서 보다 효과적으로 처리할 수 있다. 물론, rxjs4도 가능하다. 다만, 파라미터의 순서가 다르다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rxjs4</span></span><br><span class="line">distinctUntilChanged(keySelector: <span class="function"><span class="keyword">function</span>, <span class="title">comparer</span>: <span class="title">function</span>);</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// <span class="title">rxjs5</span></span></span><br><span class="line"><span class="function"><span class="title">distinctUntilChanged</span>(<span class="params">compare?: (x: K, y: K</span>) =&gt; <span class="title">boolean</span>, <span class="title">keySelector</span>?: (<span class="params">x: T</span>) =&gt; <span class="title">K</span>)</span></span><br></pre></td></tr></table></figure>

<p>compare 함수는 <code>이전 키와 이후 키를 비교 하는 함수</code>이고,<br>keySelector 함수는 <code>비교할 키가 무엇인지를 명시하는 함수</code>이다.<br>rxjs5에서는 다음과 같이 작성하면 이러한 문제를 손쉽게 해결 할 수 있다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Rx.Observable.of(&#123; <span class="attr">value</span>: <span class="number">10</span> &#125;, &#123; <span class="attr">value</span>: <span class="number">30</span> &#125;, &#123; <span class="attr">value</span>: <span class="number">30</span> &#125;, &#123; <span class="attr">value</span>: <span class="number">30</span> &#125;)</span><br><span class="line">  .distinctUntilChanged(<span class="function">(<span class="params">p, n</span>) =&gt;</span> p === n, x =&gt; x.value)</span><br><span class="line">  .subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x));</span><br></pre></td></tr></table></figure>

<p>결과는 예상했던 것처럼, <code>{value:10}, {value:30}</code> 만 나온다. 역시나, 좋다.</p>
<h3 id="keySelector를-이용한-꽁수"><a href="#keySelector를-이용한-꽁수" class="headerlink" title="keySelector를 이용한 꽁수"></a>keySelector를 이용한 꽁수</h3><p>위와 같이 키(value)가 명확하다면, 문제가 되지 않지만, 만약, 키로 정할 값이 명확하지 않고, 모델의 구조가 복잡하다면, keySelector 함수를 구현하기가 어렵다.</p>
<p>이런 경우는 개발 꽁수 이지만, 키를 자체적으로 만들어서 사용하는 방법이 있다.</p>
<p>예를 들어, 여러 셀들을 포함하는 spreadsheet 모델이 다음과 같고, rows안의 특정 cell의 값(value)이나, cell의 개수만 변경되는 경우라면, 사용자 고유키를 만들수 있다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spreadsheet = &#123;</span><br><span class="line">  rows: [</span><br><span class="line">    &#123; <span class="attr">row</span>: <span class="number">0</span>, <span class="attr">col</span>: <span class="number">0</span>, <span class="attr">value</span>: <span class="string">"A"</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">row</span>: <span class="number">0</span>, <span class="attr">col</span>: <span class="number">1</span>, <span class="attr">value</span>: <span class="string">"B"</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">row</span>: <span class="number">0</span>, <span class="attr">col</span>: <span class="number">2</span>, <span class="attr">value</span>: <span class="string">"C"</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>다음과 같이 row의 length와 cell의 값(value)으로 임의의 고유키를 만들수 있다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.rows.length + <span class="string">"_"</span> + x.rows.reduce( <span class="function">(<span class="params">acc, v</span>) =&gt;</span> &#123;</span><br><span class="line">        acc.push(v.value);</span><br><span class="line">        <span class="keyword">return</span> acc;</span><br><span class="line">    &#125;, []).join(<span class="string">"_"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>immutable을 사용하는 것도 좋은 방법이지만, 이런 개발 꽁수를 이용하면, <code>복사라는 비용없이</code> 객체의 변경여부를 확인할 수 있다.</p>
<p>실제 생성된 코드는 다음과 같다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">Rx.Observable.of(</span><br><span class="line">  &#123;</span><br><span class="line">    rows: [</span><br><span class="line">      &#123; <span class="attr">row</span>: <span class="number">0</span>, <span class="attr">col</span>: <span class="number">0</span>, <span class="attr">value</span>: <span class="string">"A"</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">row</span>: <span class="number">0</span>, <span class="attr">col</span>: <span class="number">1</span>, <span class="attr">value</span>: <span class="string">"B"</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">row</span>: <span class="number">0</span>, <span class="attr">col</span>: <span class="number">2</span>, <span class="attr">value</span>: <span class="string">"C"</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    rows: [</span><br><span class="line">      &#123; <span class="attr">row</span>: <span class="number">0</span>, <span class="attr">col</span>: <span class="number">0</span>, <span class="attr">value</span>: <span class="string">"A"</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">row</span>: <span class="number">0</span>, <span class="attr">col</span>: <span class="number">1</span>, <span class="attr">value</span>: <span class="string">"B"</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">row</span>: <span class="number">0</span>, <span class="attr">col</span>: <span class="number">2</span>, <span class="attr">value</span>: <span class="string">"C"</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    rows: [</span><br><span class="line">      &#123; <span class="attr">row</span>: <span class="number">0</span>, <span class="attr">col</span>: <span class="number">0</span>, <span class="attr">value</span>: <span class="string">"A"</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">row</span>: <span class="number">0</span>, <span class="attr">col</span>: <span class="number">1</span>, <span class="attr">value</span>: <span class="string">"B_changed"</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">row</span>: <span class="number">0</span>, <span class="attr">col</span>: <span class="number">2</span>, <span class="attr">value</span>: <span class="string">"C"</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line">  .distinctUntilChanged(<span class="literal">null</span>, x =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      x.rows.length +</span><br><span class="line">      <span class="string">"_"</span> +</span><br><span class="line">      x.rows</span><br><span class="line">        .reduce(<span class="function">(<span class="params">acc, v</span>) =&gt;</span> &#123;</span><br><span class="line">          acc.push(v.value);</span><br><span class="line">          <span class="keyword">return</span> acc;</span><br><span class="line">        &#125;, [])</span><br><span class="line">        .join(<span class="string">"_"</span>)</span><br><span class="line">    );</span><br><span class="line">  &#125;)</span><br><span class="line">  .subscribe(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x));</span><br></pre></td></tr></table></figure>

<p><a href="https://jsbin.com/soluwozoji/edit?js,console" rel="external nofollow noopener noreferrer" target="_blank">https://jsbin.com/soluwozoji/edit?js,console</a></p>

                    
                        

                    
                    
                        <p>
                            <a href="/blog/2016/11/04/rxjs-apply1/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/blog/2016/08/22/rxjsisusable/">
                            RxJS는 쓸 만한가?
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2016-08-22T23:52:56+09:00">
	
		    Aug 22, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/blog/categories/Tech/">Tech</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>요즘 개인적으로 관심 있는 주제가 Reactive Programming 이다. 이 Reactive Programming의 구현체(?)에 해당하는 것 중 하나가 바로 RxJS 이다. RxJS는 Angular2에서 사용되고 있다. 조만간 React도 RxJS를 채택할 것이라는 소문(?)도 들린다. 뿐만 아니라, Rx의 Observable은 이미 ES7의 정식 스펙으로 <a href="https://github.com/tc39/proposal-observable" rel="external nofollow noopener noreferrer" target="_blank">제안</a>이 되어 있기도 하다.<br>Front-End 뿐만 아니라, Android에서는 Rx가 필수 유틸이 될 정도로 자리를 잡고 있고, <a href="http://www.slideshare.net/jongwookkim/ndc14-rx-functional-reactive-programming" rel="external nofollow noopener noreferrer" target="_blank">게임 개발</a>에서도 사용하고 있는 것으로 보인다.</p>
<h3 id="학습의-진입장벽"><a href="#학습의-진입장벽" class="headerlink" title="학습의 진입장벽"></a>학습의 진입장벽</h3><p>개인적으로 Reactive Programming에 대한 학습 진입장벽이 꽤 큰 영역인것 같다.</p>
<blockquote>
<p>왜? 바로 명령형, 절차적 프로그래밍 학습에 대한 관성이 우리에게 체화되었기에 그런 것으로 보인다.</p>
</blockquote>
<p>학교나 회사에서 우리가 배우고 사용했던 프로그래밍 방식의 대부분은 <code>명령형, 절차적 프로그래밍</code>이었다. 하지만 이 Reactive Programming의 방식은 <code>데이터의 흐름을 나타내는 것</code>에 그 본질이 있다.<br>따라서, 행위에 대해 <code>명령</code>을 하는 것이 아니라, 데이터의 흐름을 <code>선언</code> 하는 것이고, 절차적으로 프로그래밍 하는 것이 아니라, 비동기, 병렬 상황에 대해 개발하는 방식이다.<br>그나마 난 JavaScript 개발자이기에 비동기 상황에 대해서는 익숙하지만, 그래도, 익숙하지 않는 방식이다.<br>한마디로, <code>개념의 전환</code>이 쉽지 않은 것 같다. ㅠㅠ</p>
<h3 id="RxJS-정말-필요한가"><a href="#RxJS-정말-필요한가" class="headerlink" title="RxJS 정말 필요한가?"></a>RxJS 정말 필요한가?</h3><p>그렇다면, Reactive Programming의 구현체(?)인 RxJS가 정말 FrontEnd 영역에서 필요할까?</p>
<img src="/blog/2016/08/22/rxjsisusable/rxjs.png">

<blockquote>
<h3 id="의문이다"><a href="#의문이다" class="headerlink" title="의문이다."></a>의문이다.</h3><p>뭔가 의미론적으로는 굉장한 좋은 녀석 같은데, 정말 좋은지 모르겠다.</p>
</blockquote>
<p>그래서 아직은 익숙하지 않는 RxJS를 이용하여, 비교적 이벤트나 비동기 상황을 제어할 필요가 있는 캐로셀(flicking) 컴포넌트를 만들어 봤다.</p>
<h4 id="RxJS-5-0을-사용하여-캐로셀을-만든-예제"><a href="#RxJS-5-0을-사용하여-캐로셀을-만든-예제" class="headerlink" title="RxJS 5.0을 사용하여 캐로셀을 만든 예제"></a>RxJS 5.0을 사용하여 캐로셀을 만든 예제</h4><iframe height="420" scrolling="no" src="//codepen.io/sculove/embed/PzgYxb/?height=420&theme-id=0&default-tab=js,result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 100%;">See the Pen <a href="http://codepen.io/sculove/pen/PzgYxb/" rel="external nofollow noopener noreferrer" target="_blank">flicking (rxjs)</a> by son chan uk (<a href="http://codepen.io/sculove" rel="external nofollow noopener noreferrer" target="_blank">@sculove</a>) on <a href="http://codepen.io" rel="external nofollow noopener noreferrer" target="_blank">CodePen</a>.
</iframe>

<h4 id="Browser-API를-사용하여-캐로셀을-만든-예제"><a href="#Browser-API를-사용하여-캐로셀을-만든-예제" class="headerlink" title="Browser API를 사용하여 캐로셀을 만든 예제"></a>Browser API를 사용하여 캐로셀을 만든 예제</h4><iframe height="420" scrolling="no" src="//codepen.io/sculove/embed/qNGdWo/?height=420&theme-id=0&default-tab=js,result&embed-version=2" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 100%;">See the Pen <a href="http://codepen.io/sculove/pen/qNGdWo/" rel="external nofollow noopener noreferrer" target="_blank">flicking (none rxjs)</a> by son chan uk (<a href="http://codepen.io/sculove" rel="external nofollow noopener noreferrer" target="_blank">@sculove</a>) on <a href="http://codepen.io" rel="external nofollow noopener noreferrer" target="_blank">CodePen</a>.
</iframe>

<h3 id="캐로셀-flicking-의-동작-방식"><a href="#캐로셀-flicking-의-동작-방식" class="headerlink" title="캐로셀(flicking)의 동작 방식"></a>캐로셀(flicking)의 동작 방식</h3><p>비교에 앞서 캐로셀(flicking) 기능 구현을 위해 필요한 핵심 로직만 좀 살펴보자.</p>
<ol>
<li>touchstart(mousedown) 발생 시</li>
</ol>
<ul>
<li>동작하고 있다는 표시(playing)을 한다. 그리고, 현재 선택 한 좌표(start)를 저장한다.</li>
</ul>
<ol start="2">
<li>touchmove(mousemove) 발생 시</li>
</ol>
<ul>
<li>playing 시에만 이벤트가 발생하고, touchstart(mousedown)에서 발생한 좌표를 기준으로 이동한 좌표(distance)를 구한다.</li>
<li>이동한 좌표 만큼 패널을 움직인다.</li>
</ul>
<ol start="3">
<li>touchend(mouseup) 발생 시</li>
</ol>
<ul>
<li>touchstart(mousedown)에서 발생한 좌표를 기준으로 이동한 좌표(distance)를 구한다. 이동한 좌표에 따라 애니메이션으로 판을 움직일지를 결정한다.</li>
<li>애니메이션으로 움직일 필요가 있을 경우, 애니메이션으로 판을 움직이고, playing 여부를 false로 지정한다.</li>
<li>판이 다음이나, 전 판으로 이동시, 순환을 위해 판의 좌표를 변경한다.</li>
</ul>
<p>위에서 언급한 것처럼 간단한 기능이지만, 이벤트 흐름이 이렇게 동작할 거라고 이해를 해야만 개발을 할 수 있다. 또한 애니메이션 구현도 해야만 한다.</p>
<h3 id="중요한-로직-비교"><a href="#중요한-로직-비교" class="headerlink" title="중요한 로직 비교"></a>중요한 로직 비교</h3><h4 id="touchstart-touchmove-touchend-이벤트-처리"><a href="#touchstart-touchmove-touchend-이벤트-처리" class="headerlink" title="touchstart - touchmove - touchend 이벤트 처리"></a>touchstart - touchmove - touchend 이벤트 처리</h4><h5 id="RxJS"><a href="#RxJS" class="headerlink" title="RxJS"></a>RxJS</h5><p>touchstart이벤트 발생시, do로 작업을 하고, move 이벤트 발생시에는 start좌표와의 차이(distance)의 데이터로 변환하고, 이 데이터의 변경이 있을 경우, _renderMove 함수로 실제 패널을 움직인다. 이 작업은 touchend 이벤트가 끝나는 순간까지 stream을 발생 하고, 이를 계속 반복한다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// change$</span></span><br><span class="line">Rx.Observable.fromEvent(el, EVENTS.start)</span><br><span class="line">  .map(getPos)</span><br><span class="line">  .do(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.playing = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">this</span>.startSubject.next(v);</span><br><span class="line">  &#125;)</span><br><span class="line">  .flatMap(<span class="function"><span class="params">v</span> =&gt;</span></span><br><span class="line">    Rx.Observable.combineLatest(</span><br><span class="line">      <span class="keyword">this</span>.startSubject,</span><br><span class="line">      Rx.Observable.fromEvent(el, EVENTS.move).map(getPos),</span><br><span class="line">      (s, m) =&gt; m - s</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line">  .distinctUntilChanged()</span><br><span class="line">  .do(<span class="function"><span class="params">v</span> =&gt;</span> <span class="keyword">this</span>._renderMove(v))</span><br><span class="line">  .takeUntil(<span class="keyword">this</span>.end$)</span><br><span class="line">  .repeat()</span><br><span class="line">  .subscribe();</span><br></pre></td></tr></table></figure>

<h5 id="Browser-API"><a href="#Browser-API" class="headerlink" title="Browser API"></a>Browser API</h5><p>반면, RxJS를 사용하지 않은 코드는 데이터의 흐름을 코드만 보고 파악하기가 어렵다. 더불어, 별도의 변수(start, distance, …) 값들을 유지하고, onEnd 이벤트 핸들러에서 변수를 초기화 해주는 작업도 해줘야한다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.start = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">this</span>.distance = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">this</span>.onStart = el.addEventListener(EVENTS.start, e =&gt; &#123;</span><br><span class="line">  <span class="keyword">this</span>.playing = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">this</span>.start = getPos(e);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">this</span>.onMove = el.addEventListener(EVENTS.move, e =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.start === <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">let</span> distance = getPos(e) - <span class="keyword">this</span>.start;</span><br><span class="line">  <span class="keyword">this</span>.distance !== distance &amp;&amp; <span class="keyword">this</span>._renderMove(distance);</span><br><span class="line">  <span class="keyword">this</span>.distance = distance;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">this</span>.onEnd = el.addEventListener(EVENTS.end, e =&gt; &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="keyword">this</span>.start = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">this</span>.distance = <span class="literal">null</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="Animation-처리"><a href="#Animation-처리" class="headerlink" title="Animation 처리"></a>Animation 처리</h4><h5 id="RxJS-1"><a href="#RxJS-1" class="headerlink" title="RxJS"></a>RxJS</h5><p>touchend(mouseup) 이벤트가 발생할 때에 end 좌표와 start시의 좌표. 그리고 이동할 거리 등을 기준으로 <code>from, to, duration 값</code>을 계산한다.<br>계산된 정보는 _crateAnimation$에 전달 되어, 실제 애니메이션이 동작한다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">_createAnimation$(<span class="keyword">from</span>, to, duration) &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  Rx.Observable.generate(</span><br><span class="line">    performance.now(),</span><br><span class="line">    x =&gt; x &lt;= startTime + duration,</span><br><span class="line">    x =&gt; performance.now(),</span><br><span class="line">    x =&gt; (x-startTime)/duration,</span><br><span class="line">    Rx.Scheduler.animationFrame</span><br><span class="line">  )</span><br><span class="line">  .map(<span class="function"><span class="params">p</span> =&gt;</span> <span class="keyword">from</span> + (p * (next ? -distance: distance)))</span><br><span class="line">  .concat(Rx.Observable.of(to))</span><br><span class="line">  .distinctUntilChanged()</span><br><span class="line">  .do(<span class="function"><span class="params">v</span> =&gt;</span> <span class="keyword">this</span>._renderMove(v))</span><br><span class="line">  .last()</span><br><span class="line">  .do(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">    v !==<span class="number">0</span> &amp;&amp; <span class="keyword">this</span>._renderRearrange(next);</span><br><span class="line">    <span class="keyword">this</span>.playing = <span class="literal">false</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>Observable.generater를 이용하여 애니메이션 좌표가 발생하고, 이 좌표에 따라, _renderMove에 의해 실제 패널이 이동된다. 이 패널의 이동이 완료되면, 패널 이동 여부에 따라 _renderRearrange에 의해 패널의 위치가 재정의 된다. 지금 느낄지 모르겠지만, 꽤나 선언적이다.</p>
<h5 id="Browser-API-1"><a href="#Browser-API-1" class="headerlink" title="Browser API"></a>Browser API</h5><p>RxJS와 마찬가지로 touchend(mouseup) 이벤트가 발생할 때에 end 좌표와 start시의 좌표. 그리고 이동할 거리 등을 기준으로 <code>from, to, duration 값</code>을 계산한다.<br>계산된 정보는 _runAnimation에 전달 되어, 실제 애니메이션이 동작한다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">_runAnimation(<span class="keyword">from</span>, to, duration) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">let</span> self = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">let</span> startTime = performance.now();</span><br><span class="line">  <span class="keyword">let</span> p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> pos;</span><br><span class="line">  <span class="keyword">let</span> beforePos = <span class="number">-1</span>;</span><br><span class="line">  (<span class="function"><span class="keyword">function</span> <span class="title">animate</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> x = performance.now();</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= startTime + duration) &#123;</span><br><span class="line">      self._renderMove(to);</span><br><span class="line">      to !==<span class="number">0</span> &amp;&amp; self._renderRearrange(next);</span><br><span class="line">      self.playing = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    p = (x-startTime)/duration;</span><br><span class="line">    pos = <span class="keyword">from</span> + (p * (next ? -distance: distance));</span><br><span class="line">    (beforePos !== pos) &amp;&amp; self._renderMove(pos);</span><br><span class="line">    beforePos = pos;</span><br><span class="line">    <span class="built_in">window</span>.requestAnimationFrame(animate);</span><br><span class="line">  &#125;)();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>RxJS를 사용하지 않는 다음 코드는 앞의 이벤트 보다는 흐름을 알지 못해도 이해하기 쉬운 반면, 값의 변경 여부 확인이나 중간값 계산을 위한 의미론 적으로 불필요한 변수들(beforePos, p, self,..)을 사용하게 된다.</p>
<h3 id="Front-End에서-RxJS는-필요한가"><a href="#Front-End에서-RxJS는-필요한가" class="headerlink" title="Front-End에서 RxJS는 필요한가?"></a>Front-End에서 RxJS는 필요한가?</h3><p>우선 <code>코드량은 전체적으로 별차이가 없다.</code> 크롬 Timeline을 통해 애니메이션 프레임을 확인해 본 바로는 <code>속도도 별 차이가 없다.</code> 차이가 있다면, RxJS의 호출 스택이 좀 길다는 것 정도이다.<br>물론, PC에서 확인해서 그런지는 모르겠지만, 이건 RxJS를 사용하지 말아야하는 이유가 되지는 못할 것 같다.</p>
<p>단지 차이가 있다면 보다 선언적으로 프로그래밍이 된 정도? 일까?<br>RxJS의 이해도가 있는 사람은 <code>코드를 통해 의미를 찾을수 있다</code>는 장점이 있는 것 같다. 또한, 기본적으로 제공하는 좋은 operator가 있어서 좀 <code>지저분한 변수들이 없어지는 장점</code>도 있다. 하지만, <code>디버깅면에서는 좀 단점</code>인것 같다. <code>do</code> operator를 통해 확인하는 방법이 최선인것 같다.</p>
<p>지금 상황에서 RxJS 를 쓸거냐고 누군가가 물어본다면…<br>내 대답은 <code>실시간 채팅</code>이나 <code>실시간 SNS</code> 정도면 모를까. 지금의 웹서비스에 적합할 지는 모르겠다.</p>
<p>솔직히 지금은 내가 내공이 약해서 잘 모르겠다.<br>지금 짠 코드도 진짜 RxJS를 잘 활용한 것인지도 모르겠다.<br>암튼 더 관심을 가지고 봐야할 주제인 것 같긴하다 ^^;;</p>

                    
                        

                    
                    
                        <p>
                            <a href="/blog/2016/08/22/rxjsisusable/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/blog/2016/08/16/angular-rc5/">
                            Angular2가 기대되는 이유. Angular2 Rc5 변경 사항
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2016-08-16T23:09:18+09:00">
	
		    Aug 16, 2016
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/blog/categories/Tech/">Tech</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h3 id="Angular2-rc5-Component에서-ngModule-단위로"><a href="#Angular2-rc5-Component에서-ngModule-단위로" class="headerlink" title="Angular2 rc5: Component에서 ngModule 단위로"></a>Angular2 rc5: Component에서 ngModule 단위로</h3><p>2016년 8월 9일 <a href="https://github.com/angular/angular/tree/2.0.0-rc.5/" rel="external nofollow noopener noreferrer" target="_blank">Angular2 rc5</a>가 발표되었다. Angular2 rc5에서는 전체적으로 구조 자체를 바꾸었다. 기존 Angular1이 module 방식을 채택했던 것에 비해 Angular2는 React와 같이 Component 단위로 구성되었다. 하지만, rc5에서는 다시 예전의 모습으로 돌아왔다.</p>
<img src="/blog/2016/08/16/angular-rc5/module_component.jpg">

<p><code>그렇다면, Angular2는 Component 방식에서 Angular1에서 쓰던 module 방식으로 왜 돌아 왔을까?</code></p>
<blockquote>
<p>어떤 기능(feature)을 구현하기에 Component는 너무 작은 단위이다.</p>
</blockquote>
<p>하나의 기능(feature)를 개발하기 위해서는 UI를 구성하는 View가 있을 수 있고, 기능을 담당하는 service가 있을 수 있다. 더불어, feature내에서 사용하는 pipe나 directive도 존재할 수 있다.<br>ngModule은 이런 Component, Direcitve, Pipe, serice를 하나로 묶어서 관리 할수 있는 단위이다.<br>각각의 요소들이 ngModule 단위로 묶이다 보니 ngModule 단위의 <code>배포나 관리</code> 또한 편해졌다.<br>더불어, Router에서 ngModule 단위로 <code>Lazy Loading</code>도 가능해 졌다.</p>
<blockquote>
<p>ngModule 내에서의 Dependency는 공유된다.</p>
</blockquote>
<p>이젠 이전 버전에 무의식적으로 넣었던 <code>module.id</code>도 더 이상 코드에 기술 할 필요가 없고, Component별로 명시하던 <code>directives, pipes, 등</code>도 더 이상 기술 할 필요가 없다.<br>모두 ngModule에 명시하면 된다. 이 방식의 장점은 ngModule에서 dependency를 관리하고, 실제 사용하는 dependency를 한 눈에 다~ 볼 수 있다. 뿐만 아니라, 코드도 더 간결해진다.<br>이렇게 할수 있는 이유는 바로 ngModule이 JavaScript의 module과 같이 module 단위로 scope를 갖기 때문에, ngModule에 명시된 Component들은 ngModule에 명시된 dependencie 객체들(directive, pipe, service, component)을 자유롭게 사용할 수 있다.<br>참고로, Component의 directives, pipes들은 <a href="https://docs.google.com/document/d/1isijHlib4fnukj-UxX5X1eWdUar6UkiGKPDFlOuNy1U/pub#h.5fritim1x5kz" rel="external nofollow noopener noreferrer" target="_blank">depreacted</a> 되었다.</p>
<p>하지만, 불편한 것도 있다. ngModule에서 쓰는 모든 자원을 declarations이나 providers로 수동으로 명시 해줘야하는 번거로움(?)이 있다. 또한, React와 다르게 Component 기반이 아닌 ngModule 단위의 접근으로 바뀌다 보니, 가벼운 느낌보다도 뭔가 무거워진 느낌도 든다.</p>
<p>rc5에 대한 자세한 사항은 다음 링크를 확인해보기 바란다.</p>
<ul>
<li><a href="https://angular.io/docs/ts/latest/guide/ngmodule.html" rel="external nofollow noopener noreferrer" target="_blank">https://angular.io/docs/ts/latest/guide/ngmodule.html</a></li>
<li><a href="https://angularjs.blogspot.kr/2016/08/angular-2-rc5-ngmodules-lazy-loading.html" rel="external nofollow noopener noreferrer" target="_blank">https://angularjs.blogspot.kr/2016/08/angular-2-rc5-ngmodules-lazy-loading.html</a></li>
</ul>
<h3 id="Angular2는-왜-자꾸-인터페이스를-바꾸는가"><a href="#Angular2는-왜-자꾸-인터페이스를-바꾸는가" class="headerlink" title="Angular2는 왜 자꾸 인터페이스를 바꾸는가?"></a>Angular2는 왜 자꾸 인터페이스를 바꾸는가?</h3><p>기존 rc4에서는 router와 form에 대한 인터페이스를 바꾸더니, 이번에는 Component 기반의 구조에서 ngModule 기반으로 구조 자체를 변경하였다.<br>일반적인 프로세스 단계로 봤을 때, <a href="https://en.wikipedia.org/wiki/Software_release_life_cycle#Release_candidate" rel="external nofollow noopener noreferrer" target="_blank">rc(Release Candidate)</a> 버전은 인터페이스 변경보다는 버그 개선에 포커스가 맞춰져 있지만, Angular2는 rc가 발표될 때마다 대다수 인터페이스를 변경하고 있다.</p>
<blockquote>
<p>지금 서비스에 Angular2를 도입하려는 사람들에게는 지극히 비상식적인 일인 것 같지만, 다른 한편으로는 고무적인 일 인것 같다. 물론 개인적인 생각이다.</p>
</blockquote>
<p>모든 S/W가 마찬가지겠지만, 특히 프레임워크가 한 번 릴리즈 된 이후, 인터페이스를 변경하는 것은 정말 어려운 일이다. 따라서, 정말 잘 결정해야만 한다. 그러기 위해서는 사용자의 피드백을 중심으로 논의가 이루어져야 하며, 그 논의의 결과가 프레임워크에 반영되어야 할 것이다.<br>Angular2는 이런면에서 사용자의 피드백을 열심히 받고 있는 것 같다. 다양한 의견들에 대한 논의가 이루어지고 있고 이로 인해 Angular2가 변해가고 있다.</p>
<blockquote>
<p>ngModule에 대한 어느 사용자의 커멘트 <a href="https://github.com/angular/angular/issues/10552#issuecomment-238819504" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/angular/angular/issues/10552#issuecomment-238819504</a></p>
</blockquote>
<p>지금까지의 Angular2의 행보로 본다면, Angular1과 React에서 많은 교훈 점을 찾고자 노력하고 있는 모습이 역력하다.</p>
<p>React의 단방향 설계와 성능적인 장점 요소를 가져오면서도,<br>Angular1이 가지고 있었던 프레임워크의 역할과 개발생산성의 장점을 모두 잡으려고 하는 노력이 보인다. 더불어, ember 프레임워크의 장점 중의 하나인 ember-cli도 angular-cli를 통해 하나 하나 흡수해 나가고 있다.</p>
<p>앞으로 정식 릴리즈가 될 때까지 얼마나 많은 rc가 배포 될지는 모르지만…<br>고민한 만큼 뭔가 대단한 녀석이 나올 것만 같다.</p>
<img src="/blog/2016/08/16/angular-rc5/angularman.png">

                    
                        

                    
                    
                        <p>
                            <a href="/blog/2016/08/16/angular-rc5/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
          <li class="pagination-prev">
            <a class="btn btn--default btn--small" href="/blog/categories/Tech/">
              <i class="fa fa-angle-left text-base icon-mr"></i>
              <span>NEWER POSTS</span>
            </a>
          </li>
        
        
          <li class="pagination-next">
            <a class="btn btn--default btn--small" href="/blog/categories/Tech/page/3/">
              <span>OLDER POSTS</span>
              <i class="fa fa-angle-right text-base icon-ml"></i>
            </a>
          </li>
        
        <li class="pagination-number">page 2 of 4</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2019 sculove. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/blog/assets/images/sculove.jpeg" alt="Author&#39;s picture">
        
            <h4 id="about-card-name">sculove</h4>
        
            <div id="about-card-bio"><p>아내와 아들 그리고 딸밖에 모르는 남편</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>FrontEnd Developer</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br>
                대한민국/서울
            </div>
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="external nofollow noopener noreferrer" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search" class="form-control input--large search-input" placeholder="Search ">
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">no post found</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://sculove.github.io/blog/2011/05/14/building-rich/">
                            <h3 class="media-heading">빌딩부자들</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    May 14, 2011
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://sculove.github.io/blog/2012/02/19/donot-speak-book/">
                            <h3 class="media-heading">뱀의 뇌에게 말을 걸지마라</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Feb 19, 2012
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://sculove.github.io/blog/2012/02/29/manager-book/">
                            <h3 class="media-heading">만약 고교야구 여자 매니저가 피터드러커를 읽는다면</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Feb 29, 2012
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://sculove.github.io/blog/2012/03/18/myjob-myhappy/">
                            <h3 class="media-heading">내가 하는 일 가슴 설레는 일</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Mar 18, 2012
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://sculove.github.io/blog/2013/11/06/mobile-es5-compatiable/">
                            <h3 class="media-heading">모바일 브라우저 ECMAScript5 지원 현황</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Nov 6, 2013
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://sculove.github.io/blog/2013/12/05/animation-for-performance/">
                            <h3 class="media-heading">애니메이션 성능을 높이는 방법</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Dec 5, 2013
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://sculove.github.io/blog/2014/11/19/How-to-make-a-smooth-animation/">
                            <h3 class="media-heading">How to Make a Smooth Animation</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Nov 19, 2014
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://sculove.github.io/blog/2015/01/16/angular1-for-performance/">
                            <h3 class="media-heading">AngularJS 성능 이슈에 대한 이야기</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Jan 16, 2015
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://sculove.github.io/blog/2015/09/03/Ftp-settings-in-OSX/">
                            <h3 class="media-heading">Anonymous FTP Settings in OSX</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Sep 3, 2015
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="http://sculove.github.io/blog/2015/09/03/Apache2-settings-in-OSX/">
                            <h3 class="media-heading">Apache2 Settings in OSX</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    Sep 3, 2015
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium" data-message-zero="no post found" data-message-one="1 post found" data-message-other="{n} posts found">
                67 posts found
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/blog/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/blog/assets/js/jquery.js"></script>
<script src="/blog/assets/js/jquery.fancybox.js"></script>
<script src="/blog/assets/js/thumbs.js"></script>
<script src="/blog/assets/js/tranquilpeak.js"></script>
<!--SCRIPTS END-->


    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.14.1/moment-with-locales.min.js"></script>
    <script src="//cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
    <script>
        var algoliaClient = algoliasearch('0E46FZ0JA2', '01370395a4f67d606d12d489c615c822');
        var algoliaIndex = algoliaClient.initIndex('sculove.github.io');
    </script>


    </body>
</html>
